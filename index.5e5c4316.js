var e=Object.defineProperty,t=Object.getOwnPropertySymbols,d=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable,o=(t,d,i)=>d in t?e(t,d,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[d]=i;import{e as n,m as a,o as r,c as s,r as l,a as c,w as h,d as u,F as p,b as m,f,t as N,g,h as b,i as y,j as v,k as C,p as w,l as O,n as A,_ as E,q as I,s as T,u as M,v as k,x as _}from"./vendor.77ebe15e.js";function R(){}const S={name:"MonacoEditor",emits:["change","input"],props:{diffEditor:{type:Boolean,default:!1},width:{type:[String,Number],default:"100%"},height:{type:[String,Number],default:"100%"},original:String,value:String,language:{type:String,default:"javascript"},theme:{type:String,default:"vs"},options:{type:Object,default:()=>({})},editorMounted:{type:Function,default:R},editorBeforeMount:{type:Function,default:R}},watch:{options:{deep:!0,handler(e){this.editor&&this.editor.updateOptions(e)}},value(){this.editor&&this.value!==this._getValue()&&this._setValue(this.value)},language(){if(this.editor)if(this.diffEditor){const{original:e,modified:t}=this.editor.getModel();n.setModelLanguage(e,this.language),n.setModelLanguage(t,this.language)}else n.setModelLanguage(this.editor.getModel(),this.language)},theme(){this.editor&&n.setTheme(this.theme)},style(){this.editor&&this.$nextTick((()=>{this.editor.layout()}))}},computed:{style(){return{width:/^\d+$/.test(this.width)?`${this.width}px`:this.width,height:/^\d+$/.test(this.height)?`${this.height}px`:this.height}}},mounted(){this.$nextTick((()=>{this.initMonaco()}))},unmounted(){this.editor&&this.editor.dispose(),this.editor=null},methods:{initMonaco(){const{value:e,language:a,theme:r,options:s}=this;Object.assign(s,this._editorBeforeMount());const l=((e,n)=>{for(var a in n||(n={}))d.call(n,a)&&o(e,a,n[a]);if(t)for(var a of t(n))i.call(n,a)&&o(e,a,n[a]);return e})({value:e,language:a,theme:r},s);this.editor=n[this.diffEditor?"createDiffEditor":"create"](this.$el,l),this.diffEditor&&this._setModel(this.value,this.original),this._editorMounted(this.editor)},_getEditor(){return this.editor?this.diffEditor?this.editor.modifiedEditor:this.editor:null},_setModel(e,t){const{language:d}=this,i=n.createModel(t,d),o=n.createModel(e,d);this.editor.setModel({original:i,modified:o})},_setValue(e){let t=this._getEditor();if(t)return t.setValue(e)},_getValue(){let e=this._getEditor();return e?e.getValue():""},_editorBeforeMount(){return this.editorBeforeMount(a)||{}},_editorMounted(e){this.editorMounted(e,a),this.diffEditor?e.onDidUpdateDiff((e=>{const t=this._getValue();this._emitChange(t,e)})):e.onDidChangeModelContent((e=>{const t=this._getValue();this._emitChange(t,e)}))},_emitChange(e,t){this.$emit("change",e,t),this.$emit("input",e)}}};let D;S.render=function(e,t,d,i,o,n){return r(),s("div",{class:"monaco_editor_container",style:n.style},null,4)};const L={},P={name:"AddNodeBtn",emits:["add"],data:()=>({popoverShow:!1}),methods:{addClick(e){this.popoverShow=!1,this.$emit("add",e)}}},B={class:"add-node-btn"},V={class:"add-node-group"},x=c("div",{class:"add-node-reference"},[c("span",{class:"el-icon-plus"})],-1);P.render=function(e,t,d,i,o,n){const a=l("el-popover");return r(),s("div",B,[c(a,{visible:o.popoverShow,"onUpdate:visible":t[4]||(t[4]=e=>o.popoverShow=e),"show-arrow":!1,"hide-after":0,transition:"false",placement:"right-start","popper-class":"add-node-popover",trigger:"click"},{reference:h((()=>[x])),default:h((()=>[c("div",V,[c("div",{class:"add-node-item",onClick:t[1]||(t[1]=e=>n.addClick("APPROVAL"))},"审批人"),c("div",{class:"add-node-item",onClick:t[2]||(t[2]=e=>n.addClick("ROUTE"))},"条件分支"),c("div",{class:"add-node-item",onClick:t[3]||(t[3]=e=>n.addClick("ACTION"))},"任务动作")])])),_:1},8,["visible"])])};const $={name:"FlowRouteNode",emits:["add","addBranch"],components:{AddNodeBtn:P,FlowBranchNode:u((()=>function(e,t){if(!t)return e();if(void 0===D){const e=document.createElement("link").relList;D=e&&e.supports&&e.supports("modulepreload")?"modulepreload":"preload"}return Promise.all(t.map((e=>{if(e in L)return;L[e]=!0;const t=e.endsWith(".css"),d=t?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${e}"]${d}`))return;const i=document.createElement("link");return i.rel=t?"stylesheet":D,t||(i.as="script",i.crossOrigin=""),i.href=e,document.head.appendChild(i),t?new Promise(((e,t)=>{i.addEventListener("load",e),i.addEventListener("error",t)})):void 0}))).then((()=>e()))}((()=>Promise.resolve().then((function(){return ce}))),void 0)))},props:{node:Object},methods:{handleAdd(e){this.$emit("add",e)},addBranchClick(){this.$emit("addBranch")}}},F={class:"flow-route-node"},j=c("div",{class:"top-h-line"},null,-1),U={class:"branchs"},X=c("div",{class:"bottom-h-line"},null,-1),z=c("div",{class:"v-line"},null,-1);$.render=function(e,t,d,i,o,n){const a=l("flow-branch-node"),h=l("add-node-btn");return r(),s("div",F,[j,c("div",{class:"add-branch-btn",onClick:t[1]||(t[1]=(...e)=>n.addBranchClick&&n.addBranchClick(...e))},"添加条件"),c("div",U,[(r(!0),s(p,null,m(d.node.data.children,((e,t)=>(r(),s(a,{key:e.id,node:e,"route-node":d.node,"branch-index":t,"branch-count":d.node.data.children.length},null,8,["node","route-node","branch-index","branch-count"])))),128))]),X,z,c(h,{onAdd:n.handleAdd},null,8,["onAdd"])])};var G=f();const H={name:"FlowEditorNode",components:{AddNodeBtn:P},props:{node:Object,title:String,content:String,placeholder:{type:String,default:"请配置节点内容"},closeable:{type:Boolean,default:!0},bgColor:{type:String,default:"#1890ff"},titleColor:{type:String,default:"#fff"},branchIndex:Number,branchCount:Number},data:()=>({showDeleteModal:!1}),methods:{nodeClick(){this.node&&G.emit("node_click",this.node)},handleAdd(e){this.$emit("add",e)},deleteClick(){this.showDeleteModal=!0},deleteConfirm(){this.$emit("delete"),this.showDeleteModal=!1},deleteCancel(){this.showDeleteModal=!1}}},q={class:"flow-editor-node"},J={class:"node-content"},W={key:0,class:"node-content__inner"},K={key:1,class:"node-content__inner node-content__placeholder"},Q={key:1,class:"close-modal"},Y=v("取消"),Z=v("删除"),ee={key:2,class:"el-icon-warning"},te=c("div",{class:"v-line"},null,-1);H.render=function(e,t,d,i,o,n){const a=l("el-button"),u=l("add-node-btn");return r(),s("div",q,[c("div",{style:{background:d.bgColor},class:"flow-editor-node-container",onClick:t[2]||(t[2]=(...e)=>n.nodeClick&&n.nodeClick(...e))},[c("div",{style:{color:d.titleColor},class:"node-title"},[c("span",null,N(d.title),1)],4),c("div",J,[d.content?(r(),s("div",W,N(d.content),1)):(r(),s("div",K,N(d.placeholder),1))]),g(e.$slots,"default"),d.closeable?(r(),s("i",{key:0,class:"close-btn el-icon-close",onClick:t[1]||(t[1]=b(((...e)=>n.deleteClick&&n.deleteClick(...e)),["stop"]))})):y("",!0),o.showDeleteModal?(r(),s("div",Q,[c(a,{size:"mini",onClick:b(n.deleteCancel,["stop"])},{default:h((()=>[Y])),_:1},8,["onClick"]),c(a,{size:"mini",type:"danger",onClick:b(n.deleteConfirm,["stop"])},{default:h((()=>[Z])),_:1},8,["onClick"])])):y("",!0),d.node.isError?(r(),s("i",ee)):y("",!0)],4),"END"!==d.node.type?(r(),s(p,{key:0},[te,c(u,{onAdd:n.handleAdd},null,8,["onAdd"])],64)):y("",!0)])};const de={name:"FlowConditionNode",components:{FlowEditNode:H},inject:["getFlowStore"],props:{branchIndex:Number,branchCount:Number},computed:{flowStore(){return this.getFlowStore()},showLeftMove(){return this.branchIndex!==this.branchCount-1&&this.branchIndex>0},showRightMove(){return this.branchIndex!==this.branchCount-1&&this.branchIndex<this.branchCount-2}},methods:{moveToleft(){this.flowStore.moveCondition(this.$attrs.node.id,this.branchIndex-1)},moveToRight(){this.flowStore.moveCondition(this.$attrs.node.id,this.branchIndex+1)}}};de.render=function(e,t,d,i,o,n){const a=l("flow-edit-node");return r(),s(a,C(e.$attrs),{default:h((()=>[n.showLeftMove?(r(),s("i",{key:0,class:"el-icon-caret-left arrow-left",onClick:t[1]||(t[1]=b(((...e)=>n.moveToleft&&n.moveToleft(...e)),["stop"]))})):y("",!0),n.showRightMove?(r(),s("i",{key:1,class:"el-icon-caret-right arrow-right",onClick:t[2]||(t[2]=b(((...e)=>n.moveToRight&&n.moveToRight(...e)),["stop"]))})):y("",!0)])),_:1},16)};const ie={name:"FlowBranchNode",components:{FlowEditNode:H,FlowRouteNode:$,FlowConditionNode:de},inject:["getFlowStore"],props:{node:Object,routeNode:Object,branchIndex:Number,branchCount:Number},data:()=>({backgroundMap:{START:"#a9b4cd",END:"#a9b4cd",CONDITION:"#52c41a",APPROVAL:"#faad14",ACTION:"#722ed1"}}),computed:{flowStore(){return this.getFlowStore()}},methods:{handleAddBranch(e){this.flowStore.addBranch(e.id)},handleAdd(e,t){this.flowStore.addNext(e.id,t)},handleDelete(e){this.flowStore.deleteNode(e.id)}}},oe={class:"flow-branch-node"},ne=c("div",{class:"top-line-mask"},null,-1),ae=c("div",{class:"top-v-line"},null,-1),re={class:"nodes"},se=c("div",{class:"bottom-v-line"},null,-1),le=c("div",{class:"bottom-line-mask"},null,-1);ie.render=function(e,t,d,i,o,n){const a=l("flow-route-node"),h=l("flow-condition-node"),u=l("flow-edit-node");return r(),s("div",oe,[ne,ae,c("div",re,[(r(!0),s(p,null,m(d.node.data.children,(e=>(r(),s(p,null,["ROUTE"===e.type?(r(),s(a,{key:e.id,node:e,class:e.type,onAdd:t=>n.handleAdd(e,t),onAddBranch:t=>n.handleAddBranch(e)},null,8,["node","class","onAdd","onAddBranch"])):"CONDITION"===e.type?(r(),s(h,{key:e.id,node:e,class:e.type,title:e.data.name,"bg-color":o.backgroundMap[e.type],closeable:!e.data.isDefault,"branch-index":d.branchIndex,"branch-count":d.branchCount,onAdd:t=>n.handleAdd(e,t),onDelete:t=>n.handleDelete(e)},null,8,["node","class","title","bg-color","closeable","branch-index","branch-count","onAdd","onDelete"])):(r(),s(u,{key:e.id,node:e,class:e.type,title:e.data.name,"bg-color":o.backgroundMap[e.type],closeable:!["START","END"].includes(e.type)&&!e.data.isDefault,onAdd:t=>n.handleAdd(e,t),onDelete:t=>n.handleDelete(e)},null,8,["node","class","title","bg-color","closeable","onAdd","onDelete"]))],64)))),256))]),se,le])};var ce=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:ie});const he={name:"TitleInput",emits:["update:modelValue"],props:{modelValue:String,disabled:{type:Boolean,default:!1}},data:()=>({titleEdit:!1}),methods:{showEdit(){this.disabled||(this.titleEdit=!0)},hideEdit(){this.titleEdit=!1},handleUpdate(e){this.$emit("update:modelValue",e)}}},ue=A();w("data-v-5f92d3af");const pe={key:1};O();const me=ue(((e,t,d,i,o,n)=>{const a=l("el-input");return r(),s("div",{class:"u-title",onClick:t[1]||(t[1]=(...e)=>n.showEdit&&n.showEdit(...e))},[o.titleEdit?(r(),s(a,{key:0,modelValue:d.modelValue,"onUpdate:modelValue":n.handleUpdate,onBlur:n.hideEdit},null,8,["modelValue","onUpdate:modelValue","onBlur"])):(r(),s("span",pe,N(d.modelValue),1))])}));he.render=me,he.__scopeId="data-v-5f92d3af";const fe={name:"EditPanel",components:{TitleInput:he},inject:["getFlowStore"],props:{node:Object},data:()=>({editNode:null}),computed:{flowStore(){return this.getFlowStore()}},watch:{"$attrs.modelValue"(e){e&&(this.editNode=E.cloneDeep(this.node))}},methods:{handleCancel(){this.$emit("update:modelValue",!1)},handleConfirm(){this.flowStore.updateNodeData(this.node.id,this.editNode.data),this.$emit("update:modelValue",!1)}}},Ne=A();w("data-v-470df0f2");const ge={key:0,class:"edit-panel"},be=c("div",{class:"edit-panel-content"},"自定义需要编辑的节点数据",-1),ye={class:"edit-panel-footer"},ve=v("取 消"),Ce=v("确 定");O();const we=Ne(((e,t,d,i,o,n)=>{const a=l("title-input"),h=l("el-button"),u=l("el-drawer");return r(),s(u,I(e.$attrs,{"with-header":!1}),{default:Ne((()=>[o.editNode?(r(),s("div",ge,[c(a,{class:"edit-panel-title",modelValue:o.editNode.data.name,"onUpdate:modelValue":t[1]||(t[1]=e=>o.editNode.data.name=e)},null,8,["modelValue"]),be,c("div",ye,[c(h,{onClick:n.handleCancel},{default:Ne((()=>[ve])),_:1},8,["onClick"]),c(h,{type:"primary",onClick:n.handleConfirm},{default:Ne((()=>[Ce])),_:1},8,["onClick"])])])):y("",!0)])),_:1},16)}));function Oe(e,t,d){const i=["START","END","ROUTE","APPROVAL","ACTION"];t.data.children.forEach(((o,n)=>{i.includes(o.type)&&e.nodeList.push(Object.assign({type:o.type,id:o.id},o.data)),0===n?"CONDITION"===o.type&&Ae(e,null,o,d):Ae(e,t.data.children[n-1],o,d)}))}function Ae(e,t,d,i){const o={id:"",name:"",dstId:"",srcId:"",priority:1,conditionGroupList:[]};switch(d.type){case"APPROVAL":case"ACTION":["START","APPROVAL","ACTION"].includes(t.type)&&(Object.assign(o,{id:`LINE_${T(8)}`,srcId:t.id,dstId:d.id}),e.lineList.push(o));break;case"ROUTE":["START","APPROVAL","ACTION"].includes(t.type)&&(Object.assign(o,{id:`LINE_${T(8)}`,srcId:t.id,dstId:d.id}),e.lineList.push(o)),d.data.children.forEach((function(t){Oe(e,t,d)}));break;case"CONDITION":return o.id=d.id,o.srcId=i.id,o.priority=d.data.priority,o.name=d.data.name,o.conditionGroupList=d.data.conditionGroupList,void e.lineList.push(o);case"END":["START","APPROVAL","ACTION"].includes(t.type)&&(Object.assign(o,{id:`LINE_${T(8)}`,srcId:t.id,dstId:d.id}),e.lineList.push(o))}"CONDITION"===t.type&&(e.lineList.find((e=>e.id===t.id)).dstId=d.id),"ROUTE"===t.type&&Ee(e,t,d)}function Ee(e,t,d){t.data.children.forEach((t=>{const i=t.data.children,o=i[i.length-1],n={id:`LINE_${T(8)}`,dstId:d.id,srcId:o.id,priority:1,conditionGroupList:[]};"CONDITION"!==o.type?"ROUTE"!==o.type?e.lineList.push(n):Ee(e,o,d):e.lineList.forEach((e=>{e.id===o.id&&(e.dstId=d.id)}))}))}fe.render=we,fe.__scopeId="data-v-470df0f2";const Ie=e=>e.replace(/&/g,"&amp;").replace(/ /g,"&nbsp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;");class Te{constructor({rootNode:e}={}){this.rootNode=e||this.initDefault(),this.nodeTypes=["START","END","APPROVAL","ACTION","ROUTE","BRANCH","CONDITION"],this.nodeTypeToTag={START:"start",END:"end",APPROVAL:"task",ACTION:"custom",ROUTE:"decision"},this.errorNodes=[],this.idNodeMap=new Map,this.idParentMap=new Map,this.typeNodeMap=new Map(this.nodeTypes.map((e=>[e,new Map]))),this.addDescendantsToMap(this.rootNode)}convertNode(e){return{}}buildXMLObject(e){const t=new Map,d={lineList:[],nodeList:[]},i={process:{_attributes:{displayName:Ie(e||"审批流程"),name:"process"}}};return Oe(d,this.rootNode),console.log("[debug] result",d),d.nodeList.forEach((e=>{const i={_attributes:{displayName:Ie(e.name),name:e.id}};("APPROVAL"===e.type||"ACTION"===e.type)&&(i._attributes=Object.assign(i._attributes,this.convertNode(e)));const o=d.lineList.filter((t=>t.srcId===e.id)).map((t=>{if("ROUTE"===e.type){const e=(t.conditionGroupList||[]).map((e=>e.map((e=>{this.convertNode(e)}))));return{_attributes:{displayName:Ie(t.name),name:t.id,expr:JSON.stringify(e),to:t.dstId}}}return{_attributes:{name:t.id,to:t.dstId}}}));o.length&&(i.transition=o);const n=t.get(e.type);t.set(e.type,Array.isArray(n)?[...n,i]:[i])})),t.forEach(((e,t)=>{const d=this.nodeTypeToTag[t];e.length&&(i.process[d]=e)})),i}buildXML(e){const t=this.buildXMLObject(e);return M.json2xml(t,{compact:!0,ignoreComment:!0,spaces:4})}initDefault(){const e=this.createStartNode(),t=this.createEndNode();return{id:"ROOT",type:"BRANCH",isError:!1,errors:[],data:{children:[e,this.createApprovalNode({parentBranchId:"ROOT"}),t]}}}addDescendantsToMap(e,t){this.addNodeToMap(e,t),e.data.children.forEach((t=>{this.addDescendantsToMap(t,e)}))}addNodeToMap(e,t){this.idNodeMap.set(e.id,e),this.idParentMap.set(e.id,t),this.typeNodeMap.get(e.type).set(e.id,e)}deleteDescendantsFromMap(e){this.deleteNodeFromMap(e),e.data.children.forEach((e=>{this.deleteDescendantsFromMap(e)}))}deleteNodeFromMap(e){this.idNodeMap.delete(e.id),this.idParentMap.delete(e.id),this.typeNodeMap.get(e.type).delete(e.id)}findNodeById(e){return this.findNodeRecursively(this.rootNode,e)}findNodeRecursively(e,t){if(e.id===t)return e;const d=e.data.children;for(let i=0;i<d.length;i++){const e=d[i],o=this.findNodeRecursively(e,t);if(o)return o}}createStartNode(){return{id:"START",type:"START",isError:!1,errors:[],parentBranchId:"ROOT",data:{children:[],name:"开始"}}}createEndNode(){return{id:"END",type:"END",isError:!1,errors:[],parentBranchId:"ROOT",data:{children:[],name:"结束"}}}createApprovalNode({parentBranchId:e}){return{id:`APPROVAL_${T(8)}`,type:"APPROVAL",isError:!1,errors:[],parentBranchId:e,data:{children:[],name:"审批"}}}createActionNode({parentBranchId:e}){return{id:`ACTION_${T(8)}`,type:"ACTION",isError:!1,errors:[],parentBranchId:e,data:{children:[],name:"动作"}}}createRouteNode({parentBranchId:e}){const t={id:`ROUTE_${T(8)}`,type:"ROUTE",isError:!1,errors:[],parentBranchId:e,data:{children:[],name:"路由"}};return t.data.children=new Array(2).fill("").map(((e,d)=>{const i=this.createBranchNode({parentRouteId:t.id}),o=this.createConditionNode({parentBranchId:i.id,isDefault:1===d,index:d+1});return i.data.children.push(o),i})),t}createBranchNode({parentRouteId:e}){return{id:`BRANCH_${T(8)}`,type:"BRANCH",isError:!1,errors:[],parentRouteId:e,data:{children:[],name:"分支"}}}createConditionNode({parentBranchId:e,isDefault:t,index:d=""}){return{id:`CONDITION_${T(8)}`,type:"CONDITION",isError:!1,errors:[],parentBranchId:e,data:{children:[],name:t?"默认":"条件节点"+d,isDefault:!!t}}}addNext(e,t){let d;const i=this.idParentMap.get(e),o=i.data.children.indexOf(this.idNodeMap.get(e))+1;"APPROVAL"===t?d=this.createApprovalNode({parentBranchId:i.id}):"ACTION"===t?d=this.createActionNode({parentBranchId:i.id}):"ROUTE"===t&&(d=this.createRouteNode({parentBranchId:i.id})),this.insertChild(d,i,o)}insertChild(e,t,d){t.data.children.splice(d,0,e),this.addDescendantsToMap(e,t)}addChild(e,t,d){this.insertChild(e,t,void 0!==d?d:t.data.children.length)}addBranch(e){const t=this.idNodeMap.get(e),d=this.createBranchNode({parentRouteId:e}),i=this.createConditionNode({parentBranchId:d.id,index:t.data.children.length});d.data.children.push(i),this.addChild(d,t,t.data.children.length-1),this.updateConditionPriority(t)}moveCondition(e,t){const d=this.idNodeMap.get(e),i=this.idParentMap.get(d.id),o=this.idParentMap.get(i.id),n=o.data.children.indexOf(i),a=o.data.children[t];o.data.children[n]=a,o.data.children[t]=i,o.data.children=[...o.data.children],this.updateConditionPriority(o)}updateConditionPriority(e){e.data.children.forEach(((e,t)=>{e.data.children[0].data.priority=t+1}))}updateNodeData(e,t){this.idNodeMap.get(e).data=t}deleteNode(e){const t=this.idNodeMap.get(e);if(["APPROVAL","ACTION"].includes(t.type)){const d=this.idParentMap.get(e);d.data.children.splice(d.data.children.indexOf(t),1),this.deleteDescendantsFromMap(t)}if("CONDITION"===t.type){const t=this.idParentMap.get(e),d=this.idParentMap.get(t.id);if(d.data.children.length>2)d.data.children.splice(d.data.children.indexOf(t),1),this.deleteDescendantsFromMap(t),this.updateConditionPriority(d);else{const e=this.idParentMap.get(d.id);e.data.children.splice(e.data.children.indexOf(d),1),this.deleteDescendantsFromMap(d)}}}validate(){this.errorNodes=[],this.validateNode(this.rootNode)}validateNode(e){e.data.children.forEach((e=>{switch(e.type){case"START":e.isError=!this.validateStart(e);break;case"APPROVAL":e.isError=!this.validateApproval(e);break;case"ACTION":e.isError=!this.validateAction(e);break;case"CONDITION":e.isError=!this.validateCondition(e);break;case"END":e.isError=!this.validateEnd(e);break;case"BRANCH":case"ROUTE":this.validateNode(e)}e.isError&&this.errorNodes.push(e)}))}validateStart(e){return!0}validateEnd(e){return!0}validateApproval(e){return!0}validateAction(e){return!0}validateCondition(e){return!0}}const Me={name:"FlowEditor",components:{MonacoEditor:S,FlowBranchNode:ie,EditPanel:fe},provide(){return{getFlowStore:()=>this.flowStore}},data:()=>({scale:1,flowStore:null,showEdit:!1,editNode:null,showXml:!1,xmlContent:""}),computed:{scaleStyle(){return{transform:`scale(${this.scale})`}}},mounted(){this.flowStore=new Te,window.flowStore=this.flowStore,G.on("node_click",this.handleNodeClick)},umounted(){G.off("node_click",this.handleNodeClick)},methods:{previewXML(){this.xmlContent=this.flowStore.buildXML(),this.showXml=!0},handleNodeClick(e){this.editNode=e,this.showEdit=!0},scaleClick(e){"minus"===e?this.scale=this.scale-.1:"plus"===e&&(this.scale=this.scale+.1)}}},ke={class:"flow-editor"},_e={class:"flow-editor-toolbar"},Re=v("查看XML"),Se={class:"flow-editor-toolbar__scale"},De={class:"dialog-footer"},Le=v("关 闭");Me.render=function(e,t,d,i,o,n){const a=l("el-button"),u=l("flow-branch-node"),p=l("edit-panel"),m=l("monaco-editor"),f=l("el-dialog");return r(),s("div",ke,[c("div",_e,[c(a,{type:"text",onClick:n.previewXML},{default:h((()=>[Re])),_:1},8,["onClick"]),c(a,{disabled:o.scale<=.5,icon:"el-icon-minus",size:"mini",onClick:t[1]||(t[1]=e=>n.scaleClick("minus"))},null,8,["disabled"]),c("span",Se,N((100*o.scale).toFixed(0))+"%",1),c(a,{disabled:o.scale>3,icon:"el-icon-plus",size:"mini",onClick:t[2]||(t[2]=e=>n.scaleClick("plus"))},null,8,["disabled"])]),c("div",{style:n.scaleStyle,class:"flow-editor-view"},[o.flowStore?(r(),s(u,{key:0,node:o.flowStore.rootNode},null,8,["node"])):y("",!0)],4),c(p,{modelValue:o.showEdit,"onUpdate:modelValue":t[3]||(t[3]=e=>o.showEdit=e),node:o.editNode},null,8,["modelValue","node"]),c(f,{modelValue:o.showXml,"onUpdate:modelValue":t[5]||(t[5]=e=>o.showXml=e),title:"流程XML",width:"1050px","append-to-body":""},{footer:h((()=>[c("span",De,[c(a,{type:"primary",onClick:t[4]||(t[4]=e=>o.showXml=!1)},{default:h((()=>[Le])),_:1})])])),default:h((()=>[c(m,{value:o.xmlContent,options:{fontSize:14},width:"1000",height:"500",theme:"vs-dark",language:"xml"},null,8,["value"])])),_:1},8,["modelValue"])])};k({expose:[],setup:e=>(e,t)=>(r(),s(Me))}).use(_).mount("#app");
